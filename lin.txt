–ö–æ–Ω–µ—á–Ω–æ! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü–û–î–ì–û–¢–û–í–ö–ê –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–´". –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

1. –°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
1.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ (FQDN) –∏ IP-–∞–¥—Ä–µ—Å–∞
–ù–∞ –∫–∞–∂–¥–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/hostname –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (FQDN):


sudo nano /etc/hostname
–í–≤–µ–¥–∏—Ç–µ –∏–º—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:


CR-SRV.rea25.ru
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/hosts –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å—å –¥–ª—è FQDN:


sudo nano /etc/hosts
–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:


192.168.3.100 CR-SRV.rea25.ru CR-SRV
(–ó–∞–º–µ–Ω–∏—Ç–µ IP-–∞–¥—Ä–µ—Å –∏ –∏–º—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ.)

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è Astra Linux:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.3.100
    netmask 255.255.255.0
    gateway 192.168.3.1
–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ç—å:


sudo systemctl restart networking
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS-–∏–º–µ–Ω
2.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ DNS-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ CR-SRV
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ BIND (DNS-—Å–µ—Ä–≤–µ—Ä):


sudo apt update
sudo apt install bind9 -y
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ /etc/bind/named.conf.local –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–æ–Ω—É rea25.ru:


sudo nano /etc/bind/named.conf.local
–î–æ–±–∞–≤—å—Ç–µ:


zone "rea25.ru" {
    type master;
    file "/etc/bind/db.rea25.ru";
};
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∑–æ–Ω—ã /etc/bind/db.rea25.ru:


sudo nano /etc/bind/db.rea25.ru
–î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å–∏:


$TTL 86400
@   IN  SOA ns1.rea25.ru. admin.rea25.ru. (
        2023101001 ; Serial
        3600       ; Refresh
        1800       ; Retry
        1209600    ; Expire
        86400 )    ; Minimum TTL

@   IN  NS  ns1.rea25.ru.
ns1 IN  A   192.168.3.100
CR-SRV IN A 192.168.3.100
BR-SRV1 IN A 192.168.2.200
BR-SRV2 IN A 192.168.2.100
–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ BIND:


sudo systemctl restart bind9
2.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ BR-SRV1
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ BIND:


sudo apt update
sudo apt install bind9 -y
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/bind/named.conf.local –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–æ–Ω—É:


sudo nano /etc/bind/named.conf.local
–î–æ–±–∞–≤—å—Ç–µ:


zone "rea25.ru" {
    type slave;
    masters { 192.168.3.100; };
    file "/etc/bind/db.rea25.ru";
};
–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ BIND:


sudo systemctl restart bind9
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–¥–æ—Å—Ç—É–ø–∞
3.1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH
–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, user):


sudo useradd -m -s /bin/bash user
sudo passwd user
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–æ–ª—å P@ssw0rd.

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:


sudo nano /etc/ssh/sshd_config
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:


PermitRootLogin no
PasswordAuthentication yes
–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä:


sudo systemctl restart sshd
3.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∫–ª—é—á—É –¥–ª—è root
–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Ä—É –∫–ª—é—á–µ–π –Ω–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:


ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä:


ssh-copy-id root@CR-SRV
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:


sudo nano /etc/ssh/sshd_config
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:


PermitRootLogin prohibit-password
–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä:


sudo systemctl restart sshd
4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Ç–∏–ª–∏—Ç
–ù–∞ –∫–∞–∂–¥–æ–π –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –º–∞—à–∏–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—ã curl, wget –∏ host:


sudo apt update
sudo apt install curl wget dnsutils -y
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏
–° –∫–∞–∂–¥–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥—Ä—É–≥–∏—Ö –º–∞—à–∏–Ω –ø–æ –¥–æ–º–µ–Ω–Ω—ã–º –∏–º–µ–Ω–∞–º:


ping CR-SRV.rea25.ru
ping BR-SRV1.rea25.ru
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–∞—à–∏–Ω—ã –º–æ–≥—É—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.

6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞–∂–¥—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É:


sudo reboot
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

–¢–µ–ø–µ—Ä—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞! –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–º–æ—â—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä

–Ω–∞ –∫–∞–∫–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –º–∞—à–∏–Ω–∫–∞—Ö, —á—Ç–æ –≤–≤–æ–¥–∏—Ç—å 
–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ. –ú—ã –±—É–¥–µ–º —Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ü–û–î–ì–û–¢–û–í–ö–ê –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–´", –Ω–æ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–∞—à–∏–Ω –∏ –∏—Ö —Ä–æ–ª–µ–π.

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
1.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FQDN –∏ IP-–∞–¥—Ä–µ—Å–∞
–ù–∞ –≤—Å–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö (CR-DB, CR-SRV, CR-CLI, BR-SRV1, BR-SRV2, BR-CLI) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ FQDN:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/hostname –∏ –≤–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (FQDN) –º–∞—à–∏–Ω—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è CR-SRV:


sudo nano /etc/hostname
–í–≤–µ–¥–∏—Ç–µ:


CR-SRV.rea25.ru
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ /etc/hosts:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/hosts –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å—å –¥–ª—è FQDN. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è CR-SRV:


sudo nano /etc/hosts
–î–æ–±–∞–≤—å—Ç–µ:


192.168.3.100 CR-SRV.rea25.ru CR-SRV
(–ó–∞–º–µ–Ω–∏—Ç–µ IP-–∞–¥—Ä–µ—Å –∏ –∏–º—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ.)

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, /etc/network/interfaces (–¥–ª—è Astra Linux –∏–ª–∏ Debian):


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.3.100
    netmask 255.255.255.0
    gateway 192.168.3.1
(–ó–∞–º–µ–Ω–∏—Ç–µ IP-–∞–¥—Ä–µ—Å, –º–∞—Å–∫—É –∏ —à–ª—é–∑ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ.)

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–∏:


sudo systemctl restart networking
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS-—Å–µ—Ä–≤–µ—Ä–∞
2.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ CR-SRV
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ BIND:


sudo apt update
sudo apt install bind9 -y
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–æ–Ω—ã rea25.ru:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/bind/named.conf.local:


sudo nano /etc/bind/named.conf.local
–î–æ–±–∞–≤—å—Ç–µ:


zone "rea25.ru" {
    type master;
    file "/etc/bind/db.rea25.ru";
};
–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∑–æ–Ω—ã:
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª /etc/bind/db.rea25.ru:


sudo nano /etc/bind/db.rea25.ru
–î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å–∏:


$TTL 86400
@   IN  SOA ns1.rea25.ru. admin.rea25.ru. (
        2023101001 ; Serial
        3600       ; Refresh
        1800       ; Retry
        1209600    ; Expire
        86400 )    ; Minimum TTL

@   IN  NS  ns1.rea25.ru.
ns1 IN  A   192.168.3.100
CR-SRV IN A 192.168.3.100
BR-SRV1 IN A 192.168.2.200
BR-SRV2 IN A 192.168.2.100
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ BIND:


sudo systemctl restart bind9
2.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ BR-SRV1
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ BIND:


sudo apt update
sudo apt install bind9 -y
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–æ–Ω—ã rea25.ru:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/bind/named.conf.local:


sudo nano /etc/bind/named.conf.local
–î–æ–±–∞–≤—å—Ç–µ:


zone "rea25.ru" {
    type slave;
    masters { 192.168.3.100; };
    file "/etc/bind/db.rea25.ru";
};
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ BIND:


sudo systemctl restart bind9
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–¥–æ—Å—Ç—É–ø–∞
3.1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH
–ù–∞ –≤—Å–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö (CR-DB, CR-SRV, CR-CLI, BR-SRV1, BR-SRV2, BR-CLI) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:


sudo useradd -m -s /bin/bash user
sudo passwd user
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–æ–ª—å P@ssw0rd.

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:


sudo nano /etc/ssh/sshd_config
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:


PermitRootLogin no
PasswordAuthentication yes
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ SSH-—Å–µ—Ä–≤–µ—Ä–∞:


sudo systemctl restart sshd
3.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∫–ª—é—á—É –¥–ª—è root
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π:
–ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:


ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa
–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:


ssh-copy-id root@CR-SRV
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH:
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH:


sudo nano /etc/ssh/sshd_config
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:


PermitRootLogin prohibit-password
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ SSH-—Å–µ—Ä–≤–µ—Ä–∞:


sudo systemctl restart sshd
4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Ç–∏–ª–∏—Ç
–ù–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –º–∞—à–∏–Ω–∞—Ö (CR-CLI, BR-CLI) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—ã curl, wget –∏ host:


sudo apt update
sudo apt install curl wget dnsutils -y
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏
–ù–∞ –≤—Å–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥—Ä—É–≥–∏—Ö –º–∞—à–∏–Ω –ø–æ –¥–æ–º–µ–Ω–Ω—ã–º –∏–º–µ–Ω–∞–º:


ping CR-SRV.rea25.ru
ping BR-SRV1.rea25.ru
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
–ù–∞ –≤—Å–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É:


sudo reboot
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã. –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä

–Ω–∞–¥–æ —á—Ç–æ-–Ω–∏–±—É–¥—å –¥–µ–ª–∞—Ç—å –≤ etc/network/interfaces
–î–∞, –≤ —Ñ–∞–π–ª–µ /etc/network/interfaces –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å –¥–ª—è –∫–∞–∂–¥–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –º–∞—à–∏–Ω—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã DNS –∏ —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏.

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã:

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞ –≤ /etc/network/interfaces
1.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è CR-DB
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.3.200
    netmask 255.255.255.0
    gateway 192.168.3.1
1.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è CR-SRV
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.3.100
    netmask 255.255.255.0
    gateway 192.168.3.1
1.3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è CR-CLI
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.3.10
    netmask 255.255.255.0
    gateway 192.168.3.1
1.4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è BR-SRV1
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.2.200
    netmask 255.255.255.0
    gateway 192.168.2.1
1.5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è BR-SRV2
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet static
    address 192.168.2.100
    netmask 255.255.255.0
    gateway 192.168.2.1
1.6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è BR-CLI
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª /etc/network/interfaces:


sudo nano /etc/network/interfaces
–î–æ–±–∞–≤—å—Ç–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:


auto eth0
iface eth0 inet dhcp
(BR-CLI –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å IP-–∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ DHCP.)

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–∏
–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ /etc/network/interfaces, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ç—å:


sudo systemctl restart networking
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IP-–∞–¥—Ä–µ—Å–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:


ip addr show eth0
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∞—à–∏–Ω—ã –º–æ–≥—É—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –ø–æ –¥–æ–º–µ–Ω–Ω—ã–º –∏–º–µ–Ω–∞–º:


ping CR-SRV.rea25.ru
ping BR-SRV1.rea25.ru
–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP-–∞–¥—Ä–µ—Å–∞ –¥–ª—è –≤—Å–µ—Ö –º–∞—à–∏–Ω. –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä

—Å—Ç—Ä–æ–∫–∏ 
auto lo
iface lo inet static 
–Ω–∞–¥–æ —É–±—Ä–∞—Ç—å –∏–ª–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å?
–°—Ç—Ä–æ–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º lo (loopback), –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å. –≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–≤—è–∑–∏ –≤–Ω—É—Ç—Ä–∏ —Å–∞–º–æ–π –º–∞—à–∏–Ω—ã –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–Ω–µ—à–Ω—é—é —Å–µ—Ç—å. –û–±—ã—á–Ω–æ –æ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ static —Å IP-–∞–¥—Ä–µ—Å–æ–º 127.0.0.1.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ —Ñ–∞–π–ª–µ /etc/network/interfaces:


auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
    address 192.168.3.100
    netmask 255.255.255.0
    gateway 192.168.3.1
–ß—Ç–æ –¥–µ–ª–∞—é—Ç —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏:
auto lo: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å lo –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã.
iface lo inet loopback: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å lo –∫–∞–∫ loopback (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å).
–ú–æ–∂–Ω–æ –ª–∏ —É–±—Ä–∞—Ç—å?
–î–∞, –≤—ã –º–æ–∂–µ—Ç–µ —É–±—Ä–∞—Ç—å —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ. –≠—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏, –Ω–æ loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã. –û–¥–Ω–∞–∫–æ, —ç—Ç–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–ª—É–∂–±.

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
–û—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å lo, –∫–∞–∫ –µ—Å—Ç—å. –û–Ω–∏ –Ω–µ –º–µ—à–∞—é—Ç –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–∞—à —Ñ–∞–π–ª /etc/network/interfaces –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

–ü—Ä–∏–º–µ—Ä –¥–ª—è CR-SRV:

auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
    address 192.168.3.100
    netmask 255.255.255.0
    gateway 192.168.3.1
–ü—Ä–∏–º–µ—Ä –¥–ª—è BR-CLI (—Å DHCP):

auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ç—å:


sudo systemctl restart networking
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä